<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì§„í—¬ìŠ¤ ë°ì´í„° ê´€ë¦¬ì</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { border-bottom: 2px solid #007bff; padding-bottom: 10px; color: #333; }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; background: #eee; padding: 15px; border-radius: 5px; }
        input { padding: 10px; border: 1px solid #ddd; border-radius: 4px; flex: 1; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #f8f9fa; }
        tr:hover { background: #f1f1f1; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ¢ ì‚¬ì—…ì¥ëª… í‘œì¤€í™” ì„¤ì •</h2>
    <p>ì›ë³¸ ë°ì´í„°ì˜ ì‚¬ì—…ì¥ëª…ì„ í†µê³„ìš© í‘œì¤€ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.</p>

    <div class="input-group">
        <input type="text" id="originName" placeholder="ì›ë³¸ ì´ë¦„ (ì˜ˆ: ì‚¼ì„±ì „ìDS)">
        <span style="align-self: center;">â¡ï¸</span>
        <input type="text" id="standardName" placeholder="í‘œì¤€ ì´ë¦„ (ì˜ˆ: ì‚¼ì„±ì „ì)">
        <button onclick="addRule()">ê·œì¹™ ì €ì¥</button>
    </div>

    <h3>í˜„ì¬ ì ìš©ëœ ê·œì¹™</h3>
    <table id="ruleTable">
        <thead>
            <tr>
                <th>ì›ë³¸ ì´ë¦„ (CSV)</th>
                <th>ë³€í™˜ë  ì´ë¦„ (í†µê³„ìš©)</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>
</div>

<script>
    const API_URL = "http://127.0.0.1:8000"; // ë°±ì—”ë“œ ì£¼ì†Œ

    // 1. ê·œì¹™ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadRules() {
        const res = await fetch(`${API_URL}/admin/company-map`);
        const data = await res.json();
        
        const tbody = document.querySelector("#ruleTable tbody");
        tbody.innerHTML = "";
        
        data.forEach(item => {
            const tr = `<tr>
                <td>${item.original_name}</td>
                <td style="color:blue; font-weight:bold;">${item.standard_name}</td>
            </tr>`;
            tbody.innerHTML += tr;
        });
    }

    // 2. ê·œì¹™ ì¶”ê°€í•˜ê¸°
    async function addRule() {
        const origin = document.getElementById("originName").value;
        const standard = document.getElementById("standardName").value;

        if(!origin || !standard) {
            alert("ë‘ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        const res = await fetch(`${API_URL}/admin/company-map`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ original_name: origin, standard_name: standard })
        });

        if(res.ok) {
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
            document.getElementById("originName").value = "";
            loadRules(); // ëª©ë¡ ê°±ì‹ 
        } else {
            alert("ì €ì¥ ì‹¤íŒ¨");
        }
    }

    // ì‹œì‘í•  ë•Œ ëª©ë¡ ë¡œë”©
    loadRules();
</script>

</body>
</html>