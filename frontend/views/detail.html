<div class="action-bar"
    style="justify-content:space-between; align-items:center; padding: 15px 30px; background: white; border-bottom: 1px solid #eee;">
    <!-- Search Section -->
    <div style="display:flex; gap:10px; flex:1; max-width:500px; align-items:center;">
        <div style="position:relative; flex:1;">
            <input type="text" id="dtSearchInput" class="search-input" placeholder="ì‚¬ì—…ì¥ëª… ì…ë ¥ (ìë™ì™„ì„±)"
                style="width:100%; padding:10px 15px; border-radius:20px; border:1px solid #ddd; background:#f8f9fa;"
                onclick="DetailModule.showSearchDropdown()" onfocus="DetailModule.showSearchDropdown()"
                oninput="DetailModule.filterSearchDropdown(this.value)"
                onkeydown="if(event.key==='Enter') DetailModule.renderDetailView()">
        </div>
        <button class="btn-refresh" onclick="DetailModule.renderDetailView()"
            style="background:var(--accent); color:white; padding:8px 20px; border-radius:20px; font-weight:bold;">
            <i class="fas fa-search"></i> ì¡°íšŒ
        </button>
    </div>

    <!-- Year Filter Section -->
    <div style="display:flex; items-center; gap:10px;">
        <span style="font-size:12px; font-weight:bold; color:#777; align-self:center;">ë¶„ì„ ì—°ë„:</span>
        <div id="dtYearFilter" style="display:flex; gap:5px;">
            <!-- Generated by JS -->
        </div>
    </div>
</div>

<!-- Placeholder -->
<div id="dtPlaceholder" style="text-align:center; padding:100px; color:#aaa;">
    <i class="fas fa-building" style="font-size:60px; margin-bottom:20px; color:#eee;"></i>
    <h3>ì‚¬ì—…ì¥ì„ ê²€ìƒ‰í•˜ì—¬ ìƒì„¸ ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”</h3>
    <p>ìƒë‹¨ ê²€ìƒ‰ì°½ì— ì‚¬ì—…ì¥ëª…ì„ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥´ì„¸ìš”.</p>
</div>

<!-- Main Content -->
<div id="dtDetailContent" style="display:none; padding:20px; overflow-y:auto; height:calc(100% - 80px);">

    <!-- KPI Cards -->
    <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:20px; margin-bottom:20px;">
        <div class="kpi-card glass-panel">
            <div class="label">ì´ ê²€ì§„ ê±´ìˆ˜</div>
            <div class="value" id="dtKpiCnt">-</div>
            <i class="fas fa-user-check kpi-icon"></i>
        </div>
        <div class="kpi-card glass-panel">
            <div class="label">ì´ ë§¤ì¶œì•¡</div>
            <div class="value" id="dtKpiRev">-</div>
            <i class="fas fa-won-sign kpi-icon"></i>
        </div>
        <div class="kpi-card glass-panel">
            <div class="label">í‰ê·  ê²€ì§„ ë‹¨ê°€</div>
            <div class="value" id="dtKpiAvg">-</div>
            <div class="unit">ì¸ë‹¹ í‰ê·  ë§¤ì¶œ</div>
            <i class="fas fa-chart-line kpi-icon"></i>
        </div>
        <div class="kpi-card glass-panel">
            <div class="label">ì£¼ìš” ìˆ˜ê²€ ì—°ë ¹</div>
            <div class="value" id="dtKpiAge">-</div>
            <i class="fas fa-birthday-cake kpi-icon"></i>
        </div>
    </div>

    <!-- Chart Row 1 -->
    <div style="display:grid; grid-template-columns: 2fr 1fr; gap:20px; margin-bottom:20px; min-height:400px;">
        <div class="glass-panel" style="padding:20px; display:flex; flex-direction:column;">
            <h4 class="sub-title">ğŸ“‰ ì—°ë„ë³„ ì‹¤ì  ì¶”ì´</h4>
            <div style="flex:1;">
                <canvas id="dtTrendChart"></canvas>
            </div>
            <div id="dtAnnualTable" style="margin-top:20px; border-top:1px solid #eee; padding-top:10px;"></div>
        </div>
        <div class="glass-panel" style="padding:20px; display:flex; flex-direction:column;">
            <h4 class="sub-title">ğŸ§¬ ê²€ì§„ ìœ í˜•ë³„ ë¹„ì¤‘</h4>
            <div style="flex:1;">
                <canvas id="dtTypeChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Chart Row 2: Monthly Analysis -->
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:20px; min-height:350px;">
        <div class="glass-panel" style="padding:20px; display:flex; flex-direction:column;">
            <h4 class="sub-title">ğŸ“Š ì›”ë³„ ë§¤ì¶œ í˜„í™©</h4>
            <div style="flex:1;">
                <canvas id="dtMonthRevChart"></canvas>
            </div>
        </div>
        <div class="glass-panel" style="padding:20px; display:flex; flex-direction:column;">
            <h4 class="sub-title">ğŸ“… ì›”ë³„ ìˆ˜ê²€ í˜„í™©</h4>
            <div style="flex:1;">
                <canvas id="dtMonthCntChart"></canvas>
            </div>
        </div>
    </div>

</div>

<style>
    .glass-panel {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.03);
        border: 1px solid #eee;
    }

    .kpi-card {
        padding: 20px;
        position: relative;
        overflow: hidden;
    }

    .kpi-card .label {
        font-size: 13px;
        color: #888;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .kpi-card .value {
        font-size: 24px;
        color: #2c3e50;
        font-weight: 800;
    }

    .kpi-card .unit {
        font-size: 11px;
        color: #aaa;
        margin-top: 2px;
    }

    .kpi-card .kpi-icon {
        position: absolute;
        right: 20px;
        top: 20px;
        font-size: 40px;
        color: rgba(0, 0, 0, 0.03);
    }

    .sub-title {
        font-size: 15px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 15px;
        border-left: 4px solid var(--accent);
        padding-left: 10px;
    }

    /* Year Toggle Buttons */
    .year-toggle {
        background: white;
        border: 1px solid #ddd;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 12px;
        color: #555;
        cursor: pointer;
        transition: 0.2s;
    }

    .year-toggle:hover {
        background: #f0f0f0;
    }

    .year-toggle.active {
        background: var(--accent);
        color: white;
        border-color: var(--accent);
    }

    .custom-dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 1px solid #ddd;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        max-height: 400px;
        overflow-y: auto;
        z-index: 9999;
        margin-top: 5px;
    }

    .custom-dropdown-item {
        padding: 10px 15px;
        border-bottom: 1px solid #eee;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .custom-dropdown-item:hover {
        background: #f8f9fa;
    }

    .custom-dropdown-item .rev {
        font-size: 11px;
        color: #aaa;
        font-weight: bold;
    }
</style>